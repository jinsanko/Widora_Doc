<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>Widora_How_To_OpenWrt_C_C++_Development_with_Eclipse.md</title><link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css'><style type='text/css'>html, body {overflow-x: initial !important;}html { font-size: 14px; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 1rem; line-height: 1.42857; color: rgb(51, 51, 51); overflow-x: hidden; background-color: rgb(255, 255, 255); }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: rgb(181, 214, 252); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; padding-bottom: 70px; white-space: pre-wrap; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
.typora-export #write { margin: 0px auto; }
#write > p:first-child, #write > ul:first-child, #write > ol:first-child, #write > pre:first-child, #write > blockquote:first-child, #write > div:first-child, #write > table:first-child { margin-top: 30px; }
img { max-width: 100%; }
input, button, select, textarea { color: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
::before, ::after, * { box-sizing: border-box; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write div, #write pre { width: inherit; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6 { position: relative; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
p { -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; }
.mathjax-block { margin-top: 0px; margin-bottom: 0px; -webkit-margin-before: 0rem; -webkit-margin-after: 0rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: bold; font-style: italic; }
a { cursor: pointer; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; margin: 4px 0px 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 80px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
pre { white-space: pre-wrap; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; position: relative !important; background: inherit; }
.md-fences .CodeMirror.CodeMirror-wrap { top: -1.6em; margin-bottom: -1.6em; }
.md-fences.mock-cm { white-space: pre-wrap; }
.show-fences-line-number .md-fences { padding-left: 0px; }
.show-fences-line-number .md-fences.mock-cm { padding-left: 40px; }
.footnotes { color: rgb(136, 136, 136); font-size: 0.9rem; padding-top: 1em; padding-bottom: 1em; }
.footnotes + .footnotes { margin-top: -1em; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; color: rgb(51, 51, 51); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 1rem; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: normal; text-align: left; box-sizing: content-box; direction: ltr; background: transparent; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li p, li .mathjax-block { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; }
@media print { 
  html, body { height: 100%; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  h1, h2, h3, h4, h5, h6 { break-after: avoid-page; orphans: 2; }
  p { orphans: 4; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 1cm; padding-right: 1cm; }
  .typora-export #write::after { height: 0px; }
  @page { margin: 20mm 0mm; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 2.86rem; white-space: pre-wrap; display: block; background: rgb(204, 204, 204); }
p > .md-image:only-child { display: inline-block; width: 100%; text-align: center; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.mathjax-block { white-space: pre; overflow: hidden; width: 100%; }
p + .mathjax-block { margin-top: -1.143rem; }
.mathjax-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: none; box-shadow: none; }
.task-list { list-style-type: none; }
.task-list-item { position: relative; padding-left: 1em; }
.task-list-item input { position: absolute; top: 0px; left: 0px; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc::after, .md-toc-content::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: bold; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { color: inherit; font-size: inherit; font-style: inherit; font-weight: inherit; text-decoration: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
.md-tag { opacity: 0.5; }
code { text-align: left; }
h1 .md-tag, h2 .md-tag, h3 .md-tag, h4 .md-tag, h5 .md-tag, h6 .md-tag { font-weight: initial; opacity: 0.35; }
a.md-header-anchor.md-print-anchor { border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: none !important; text-decoration: initial !important; text-shadow: initial !important; background: transparent !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.mathjax-block .MathJax_SVG_Display { text-align: center; margin: 1em 0em; position: relative; text-indent: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; width: 100%; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: monospace; }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: normal; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }


@font-face { font-family: "Open Sans"; font-style: normal; font-weight: normal; src: local("Open Sans Regular"), url("./github/400.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: normal; src: local("Open Sans Italic"), url("./github/400i.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: normal; font-weight: bold; src: local("Open Sans Bold"), url("./github/700.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: bold; src: local("Open Sans Bold Italic"), url("./github/700i.woff") format("woff"); }
html { font-size: 16px; }
body { font-family: "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; color: rgb(51, 51, 51); line-height: 1.6; }
#write { max-width: 860px; margin: 0px auto; padding: 20px 30px 100px; }
#write > ul:first-child, #write > ol:first-child { margin-top: 30px; }
body > :first-child { margin-top: 0px !important; }
body > :last-child { margin-bottom: 0px !important; }
a { color: rgb(65, 131, 196); }
h1, h2, h3, h4, h5, h6 { position: relative; margin-top: 1rem; margin-bottom: 1rem; font-weight: bold; line-height: 1.4; cursor: text; }
h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor { text-decoration: none; }
h1 tt, h1 code { font-size: inherit; }
h2 tt, h2 code { font-size: inherit; }
h3 tt, h3 code { font-size: inherit; }
h4 tt, h4 code { font-size: inherit; }
h5 tt, h5 code { font-size: inherit; }
h6 tt, h6 code { font-size: inherit; }
h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
h3 { font-size: 1.5em; line-height: 1.43; }
h4 { font-size: 1.25em; }
h5 { font-size: 1em; }
h6 { font-size: 1em; color: rgb(119, 119, 119); }
p, blockquote, ul, ol, dl, table { margin: 0.8em 0px; }
li > ol, li > ul { margin: 0px; }
hr { height: 4px; padding: 0px; margin: 16px 0px; border-width: 0px 0px 1px; border-style: none none solid; overflow: hidden; box-sizing: content-box; border-bottom-color: rgb(221, 221, 221); background-color: rgb(231, 231, 231); }
body > h2:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child + h2 { margin-top: 0px; padding-top: 0px; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child { margin-top: 0px; padding-top: 0px; }
a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 { margin-top: 0px; padding-top: 0px; }
h1 p, h2 p, h3 p, h4 p, h5 p, h6 p { margin-top: 0px; }
li p.first { display: inline-block; }
ul, ol { padding-left: 30px; }
ul:first-child, ol:first-child { margin-top: 0px; }
ul:last-child, ol:last-child { margin-bottom: 0px; }
blockquote { border-left-width: 4px; border-left-style: solid; border-left-color: rgb(221, 221, 221); padding: 0px 15px; color: rgb(119, 119, 119); }
blockquote blockquote { padding-right: 0px; }
table { padding: 0px; }
table tr { border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); margin: 0px; padding: 0px; background-color: white; }
table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
table tr th { font-weight: bold; border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr td { border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr th:first-child, table tr td:first-child { margin-top: 0px; }
table tr th:last-child, table tr td:last-child { margin-bottom: 0px; }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); }
.md-fences, code, tt { border: 1px solid rgb(221, 221, 221); border-radius: 3px; font-family: Consolas, "Liberation Mono", Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; background-color: rgb(248, 248, 248); }
.md-fences { margin-bottom: 15px; margin-top: 15px; padding: 8px 1em 6px; }
.task-list { padding-left: 0px; }
.task-list-item { padding-left: 32px; }
.task-list-item input { top: 3px; left: 8px; }
@media screen and (min-width: 914px) { 
}
@media print { 
  html { font-size: 13px; }
  table, pre { break-inside: avoid; }
  pre { word-wrap: break-word; }
}
.md-fences { background-color: rgb(248, 248, 248); }
#write pre.md-meta-block { padding: 1rem; font-size: 85%; line-height: 1.45; border: 0px; border-radius: 3px; color: rgb(119, 119, 119); margin-top: 0px !important; background-color: rgb(247, 247, 247); }
.mathjax-block > .code-tooltip { bottom: 0.375rem; }
#write > h3.md-focus::before { left: -1.5625rem; top: 0.375rem; }
#write > h4.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h5.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h6.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
.md-image > .md-meta { border: 1px solid rgb(221, 221, 221); border-radius: 3px; font-family: Consolas, "Liberation Mono", Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; color: inherit; background-color: rgb(248, 248, 248); }
.md-tag { color: inherit; }
.md-toc { margin-top: 20px; padding-bottom: 20px; }
#typora-quick-open { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); }
#typora-quick-open-item { border-color: rgb(254, 254, 254) rgb(229, 229, 229) rgb(229, 229, 229) rgb(238, 238, 238); border-style: solid; border-width: 1px; background-color: rgb(250, 250, 250); }
.on-focus-mode blockquote { border-left-color: rgba(85, 85, 85, 0.117647); }






</style>
</head>
<body class='typora-export ' >
<div  id='write'  class = 'is-node'><h1><a name='header-c1' class='md-header-anchor '></a>Widora How-To</h1><p><code>by zymxjtu</code></p><h2><a name='header-c8' class='md-header-anchor '></a>How-To OpenWrt C/C++ Development with Eclipse</h2><h2><a name='header-c9' class='md-header-anchor '></a>1 Copyright</h2><p>This How-To guide is based on the work of OpenWrt C/C++ Devopement with Eclipse by J.Kohler. Update and add some additional content.</p><p>This work is licensed under the Creative Commons Attribution-ShareAlike 3.0 Unported License. To view a copy of this license, visit <a href='http://creativecommons.org/licenses/by-sa/3.0/' target='_blank' >http://creativecommons.org/licenses/by-sa/3.0/</a> or send a letter to Creative Commons, 444 Castro Street, Suite 900, Mountain View, California, 94041, USA.</p><h2><a name='header-c14' class='md-header-anchor '></a>2 Revision history</h2><table><thead><tr><th>Revision</th><th>Date</th><th>Author</th><th>Changes</th></tr></thead><tbody><tr><td>v0.1</td><td>6 Aug 2016</td><td>zymxjtu</td><td>First draft</td></tr></tbody></table><h2><a name='header-c26' class='md-header-anchor '></a>3 Introduction</h2><p>With Eclipse, we are able to develop software for OpenWrt target devices in a very comfortable manner. Eclipse provides a complete development suite.</p><p>This document explains how to use Eclipse C/C++ IDE with OpenWrt&#39;s cross toolchain, how to setup remote target device source level debugging and remote access via eclipse.</p><p>It is shown how to write, compile and debug programs for OpenWrt target devices.
We can use Eclipse to develop software for OpenWRT target device.</p><h2><a name='header-c34' class='md-header-anchor '></a>4 Preparation</h2><h3><a name='header-c35' class='md-header-anchor '></a>4.1 Prerequisites</h3><h4><a name='header-c36' class='md-header-anchor '></a>4.1.1 Target Prerequisites</h4><p>The following packages are required on your target device:</p><ol><li>DropBear or OpenSSH installed &amp; connections can be established</li><li>openssh-sftp-server</li><li>gdbserver</li><li>libstdcpp (optional for C++)</li></ol><p>openssh-sftp-server and gdbserver can be pre-build inside the OpenWRT image. If they are not, can simply install them:</p><ol><li>SSH to OpenWRT. (Or for Widora, use onboard Serial Terminal, check <code>&quot;Widora_User_Guide_1_Before_Getting_Started&quot;</code>)</li><li>Execute <code>opkg update</code> and then <code>opkg install libstdcpp</code></li><li>Execute <code>opkg update</code> and then <code>opkg install openssh-sftp-server</code></li><li>Execute <code>opkg install gdbserver</code> to install gdbserver.</li></ol><p>  <img src='picture/000.001.png' alt='1.1.000' /></p><p>  <img src='picture/000.000.png' alt='1.1.000' /></p><p>For Widora, in the case that Widora is connect to an AP(Router), and our host computer is also connected to the same AP and not connected to Widora directly, and in order to be able to SSH to Widora remotely, instead of directly SSH to Widora default 192.168.1.1, we need to modify Widora configuration file <code>/etc/config/firewall</code> to unblock it. Modify config zone wan, set option input to <code>ACCEPT</code>, instead of <code>REJECT</code>, and after saving the modification, reboot the Widora:</p><p>Original:</p><p>  <img src='picture/000.002.png' alt='1.1.000' /></p><p>Modified:</p><p>  <img src='picture/000.003.0.png' alt='1.1.000' /></p><p>And verified it (SSH to Widora(192.168.8.180 in this case) remotely):</p><p>  <img src='picture/000.003.1.png' alt='1.1.000' /></p><h4><a name='header-c86' class='md-header-anchor '></a>4.1.2 OpenWRT Prerequisites</h4><p>Install OpenWrt Buildroot:</p><p><a href='https://github.com/widora/openwrt_widora' target='_blank' >https://github.com/widora/openwrt_widora</a></p><p><a href='http://wiki.openwrt.org/doc/howto/buildroot.exigence' target='_blank' >http://wiki.openwrt.org/doc/howto/buildroot.exigence</a></p><p>For OpenWrt Chaos Calmer which Widora is using, there is one isse with the gdb, detailed information here:</p><p><a href='https://dev.openwrt.org/ticket/22360' target='_blank' >https://dev.openwrt.org/ticket/22360</a></p><p><a href='https://dev.openwrt.org/changeset/46298/trunk/toolchain/gdb' target='_blank' >https://dev.openwrt.org/changeset/46298/trunk/toolchain/gdb</a></p><p>This issue will cause below problem when try to debug the user program:</p><p>  <img src='picture/000.005.png' alt='1.1.000' /></p><p>So for Widora, there is one modification need for the file <code>{Widora_Source_Dir}/toolchain/gdb/Makefile</code> (add &quot;--with-expat \&quot; as shown below):</p><p>  <img src='picture/000.004.png' alt='1.1.000' /></p><p>You also need to install &quot;libexpat1-dev&quot; on the build machine (compilation need this lib):</p><pre class='md-fences mock-cm' style='display:block;position:relative'>sudo apt-get install libexpat1-dev</pre><p>Navigate to openwrt source code trunk/root directory, and then execute “make menuconfig”:</p><p>  <img src='picture/000.006.png' alt='1.1.000' /></p><p>And check:</p><ol><li>Set the build &quot;Target System&quot;, &quot;Subtarget&quot;, &quot;Target Profile&quot;.</li><li>Enable [ * ] Build the OpenWrt SDK</li><li>Enable [ * ] Package the OpenWrt-based Toolchain</li><li>Enable [ * ] Advanced configuration options (for developers) ---&gt; Enable [ * ] Toolchain Options ---&gt; Enable [ * ] Build gdb</li><li>Save the configuration.</li></ol><p>  <img src='picture/000.007.png' alt='1.1.000' /></p><p>  <img src='picture/000.008.png' alt='1.1.000' /></p><p>  <img src='picture/000.009.png' alt='1.1.000' /></p><p>  <img src='picture/000.010.png' alt='1.1.000' /></p><p>  <img src='picture/000.011.png' alt='1.1.000' /></p><p>  <img src='picture/000.012.png' alt='1.1.000' /></p><p>  <img src='picture/000.013.png' alt='1.1.000' /></p><p>Execute “make toolchain/install” if it has not already been done. The purpose of this step is to prepare the cross compile toolchain and debugging gdb for us.</p><p>  <img src='picture/000.014.png' alt='1.1.000' /></p><p>  <img src='picture/000.015.png' alt='1.1.000' /></p><h4><a name='header-c153' class='md-header-anchor '></a>4.1.3 Eclipse Prerequisites</h4><p>Download your desired Eclipse IDE for C/C++ Developers.</p><p>For this guide, we are going to use Eclipse IDE for C/C++ Developers Eclipse Luna SR2 (4.4.2) Linux.</p><p><a href='http://www.eclipse.org/downloads/packages/release/luna/sr2' target='_blank' >http://www.eclipse.org/downloads/packages/release/luna/sr2</a></p><p>Choose your preferred version and select platform type depends on you development OS type (32 Bit / 64 Bit).</p><p>Extract archive; place it to your preferred location/directory. Execute eclipse, select your preferred workspace location if being asked and enter workbench. <strong>Note that you need Java Runtime to be able to run Eclipse.</strong></p><p>  <img src='picture/000.016.png' alt='1.1.000' /></p><p>  <img src='picture/000.017.png' alt='1.1.000' /></p><p>  <img src='picture/000.018.png' alt='1.1.000' /></p><p>  <img src='picture/000.019.png' alt='1.1.000' /></p><p>We have to install additional eclipse packages: <code>Help → Install new Software → All Available Sites</code>. And select in section <strong>“Mobile and Device Development”</strong> packages <strong>“C/C++ GCC Cross Compiler Support”</strong> and <strong>“Remote System Explorer End-User Runtime”</strong>.</p><p>If you are using Eclipse IDE for C/C++ Developers, most likely these two packages have already been installed. If you cannot find above two packages or want to check their status, uncheck <strong>“Hide items that are already installed”</strong>.</p><p>  <img src='picture/000.020.png' alt='1.1.000' /></p><p>  <img src='picture/000.021.png' alt='1.1.000' /></p><h2><a name='header-c181' class='md-header-anchor '></a>5 Project Setup</h2><h3><a name='header-c182' class='md-header-anchor '></a>5.1 Eclipse Cross Compiler Project Setup</h3><h4><a name='header-c183' class='md-header-anchor '></a>5.1.1 Setup eclipse</h4><p>Create a new project: <code>File → New C++ Project (resp. C project)</code>:</p><p>  <img src='picture/000.022.png' alt='1.1.000' /></p><p>  <img src='picture/000.023.png' alt='1.1.000' /></p><p>The next settings depend on your target device and where your buildroot has been installed.</p><p>You have to evaluate your specific target settings.</p><p>You need to specify your Cross GCC path and prefix.</p><p>For this guide, we
Navigate to openwrt source code trunk/root directory, and then execute <code>find ./staging_dir -path &quot;./staging_dir/toolchain*&quot; -name *openwrt-linux</code></p><p>  <img src='picture/000.024.png' alt='1.1.000' /></p><p>The system being used for this guide returned result of:</p><p><code>./staging_dir/toolchain-mipsel_24kec+dsp_gcc-4.8-linaro_uClibc-0.9.33.2/mipsel-openwrt-linux</code></p><p>Hence for “Cross compiler prefix” we enter <code>mipsel-openwrt-linux-</code>.</p><p>We can reuse the above finding results to get the required <strong>absolute</strong> full path of “Cross compiler path”:</p><p><code>[YOUR_OPENWRT_TRUNK]/staging_dir/toolchain-mipsel_24kec+dsp_gcc-4.8-linaro_uClibc-0.9.33.2/</code></p><p><strong>Don&#39;t forget to adapt these settings to YOUR specific build environment, COPY + PASTE from here may not work!</strong></p><p>Finally enter your specific setting and press Finish button.</p><p>  <img src='picture/000.025.png' alt='1.1.000' /></p><h4><a name='header-c217' class='md-header-anchor '></a>5.1.2 Eclipse Project Settings</h4><p>For this guide, one simple Hello World program is going to be created to show how to setup remote target device source level debugging and remote access via eclipse.</p><p>Add src folder and source file.</p><p><code>File → New Source Folder (src)</code></p><p><code>File → New Source File (src/HelloWidora.cpp)</code></p><pre class='md-fences mock-cm' style='display:block;position:relative'>#include &lt;iostream&gt;
using namespace std;
int main()
{
	int i = 0;
	for (i=0; i&lt;10; i++)
	{
		cout &lt;&lt; &quot;Hello OpenWrt&quot; &lt;&lt; endl;
	}
	return 0;
}</pre><p>  <img src='picture/000.026.png' alt='1.1.000' /></p><p>If all was configured correctly you should be able to call <code>Project-Build all</code> without errors.
But you can&#39;t execute the created bin file on your build system; remember your binary is cross compiled.</p><p>  <img src='picture/000.027.png' alt='1.1.000' /></p><h5><a name='header-c234' class='md-header-anchor '></a>5.1.2.1 Remote Target Setup</h5><p>If you program was successfully compiled, you have to install it on your target device to execute it.</p><p>At this point Eclipse will help with nice features of remote access and remote debug, to setup remote target:</p><p>Go to <code>Window → Show View → Other… → Remote Systems</code></p><p>  <img src='picture/000.028.png' alt='1.1.000' /></p><p>And we create a new connection:</p><p>  <img src='picture/000.029.png' alt='1.1.000' /></p><p>Select Linux and “Next &gt;”:</p><p>  <img src='picture/000.030.png' alt='1.1.000' /></p><p>Now enter the target device&#39;s IP address resp. hostname and “Next &gt;”.</p><p>  <img src='picture/000.031.png' alt='1.1.000' /></p><p>Select “ssh.files” and “Next &gt;”.</p><p>  <img src='picture/000.032.png' alt='1.1.000' /></p><p>Select “processes.shell.linux” and “Next &gt;”.</p><p>  <img src='picture/000.033.png' alt='1.1.000' /></p><p>Select “ssh.shells” and “Next &gt;”. And then “Finish”.</p><p>  <img src='picture/000.034.png' alt='1.1.000' /></p><p>  <img src='picture/000.035.png' alt='1.1.000' /></p><p>Your IDE will look similar to this:</p><p>  <img src='picture/000.036.png' alt='1.1.000' /></p><h5><a name='header-c273' class='md-header-anchor '></a>5.1.2.2 Browse Your Target Device</h5><p>  <img src='picture/000.037.0.png' alt='1.1.000' /></p><p>Enter user name + password for the target device:</p><p>  <img src='picture/000.037.png' alt='1.1.000' /></p><p>For the first time, Eclipse may ask for Secure Storage master password, set your own master password and continue:</p><p>  <img src='picture/000.038.png' alt='1.1.000' /></p><p>  <img src='picture/000.039.png' alt='1.1.000' /></p><p>After entering user name + password you are now able to put files on/from your target devices via drag n&#39; drop, you can even control the target&#39;s processes:</p><p>  <img src='picture/000.040.png' alt='1.1.000' /></p><p>Or you can enter a ssh terminal in eclipse or copy/execute HelloOpenWrt bin file on your target device:</p><p>  <img src='picture/000.041.png' alt='1.1.000' /></p><p>  <img src='picture/000.042.png' alt='1.1.000' /></p><h5><a name='header-c296' class='md-header-anchor '></a>5.1.2.3 Remote gdb Debugger Setup</h5><p>For target device remote debugging at first we have to define a debug configuration
Left click on arrow of the “bug”-button to enter “Debug Configurations”</p><p>  <img src='picture/000.043.png' alt='1.1.000' /></p><p>And we create a new C/C++ Remote Application Debug Configuration:</p><p>  <img src='picture/000.044.png' alt='1.1.000' /></p><ul><li><p>In “Main” at C/C++ App adapt local file path to your application.</p></li><li><p>Change at “Connection” to your already defined target device remote connection (see Remote Target Setup).</p></li><li><p>Don&#39;t forget to define the correct “Remote Absolute File Path for C/C++ Application”</p><p><img src='picture/000.045.png' alt='1.1.000' /></p></li></ul><p>Now click on “Debugger” settings to define the correct host gdb file.</p><p>As host gdb we can&#39;t use the /usr/bin/gdb provided e.g. by Ubuntu, we must use the gdb which has been built by our toolchain. As well as the tool command prefix, the location depends on your specific target settings and we evaluate it again. It is located somewhere in <code>./build_dir</code>.</p><p>Execute: <code>find ./build_dir -executable -type f -name gdb |grep toolchain</code> as shown below.</p><p>The system being used for this guide returned result of:
<code>./build_dir/toolchain-mipsel_24kec+dsp_gcc-4.8-linaro_uClibc-0.9.33.2/gdb-linaro-7.6-2013.05/gdb/gdb</code></p><p>  <img src='picture/000.046.png' alt='1.1.000' /></p><p>We have to enter the <strong>absolute</strong> file path at “GDB debugger”, for the system being used for this guide is:</p><p><code>/home/dev101/Desktop/Prj/openwrt_widora/build_dir/toolchain-mipsel_24kec+dsp_gcc-4.8-linaro_uClibc-0.9.33.2/gdb-linaro-7.6-2013.05/gdb/gdb</code></p><p><strong>Remember these settings depend on YOUR specific build environment, COPY + PASTE from here may not work!!</strong></p><p>Other changes are not required. Now you may press “Debug” button of the settings window.</p><p>  <img src='picture/000.047.png' alt='1.1.000' /></p><h5><a name='header-c339' class='md-header-anchor '></a>5.1.2.4 Remote Debugging Example</h5><p>  <img src='picture/000.048.png' alt='1.1.000' /></p><p>When you launch Debug the Debug View of eclipse will be opened:</p><p>  <img src='picture/000.049.png' alt='1.1.000' /></p><p>  <img src='picture/000.050.png' alt='1.1.000' /></p><p>The above red color warning can be ignored since you haven&#39;t enabled <code>“Advanced configuration options (for developers)-&gt;Build Options-&gt;Debugging”</code> in OpenWrt build settings and rebuild all with debugging information for your Widora firmware.</p><h2><a name='header-c351' class='md-header-anchor '></a>6 Finish</h2><p>Congratulations, now you have a complete OpenWrt Development Suite! You can develop your C/C++ program in Eclipse IDE, Cross-Compile it, set break points and do remote debugging.</p><p>  <img src='picture/000.051.png' alt='1.1.000' /></p><p>  <img src='picture/000.052.png' alt='1.1.000' /></p></div>
</body>
</html>